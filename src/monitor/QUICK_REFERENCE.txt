â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  HECI MONITOR - QUICK REFERENCE CARD                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LOCATION: /home/zero/FirmwareGuard/src/monitor/

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš¡ QUICK BUILD & RUN

  cd /home/zero/FirmwareGuard/src/monitor
  make
  sudo ./heci_test 30

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ FILES OVERVIEW

  heci_monitor.h          - Public API (include this in your code)
  heci_monitor.c          - Implementation (link heci_monitor.o)
  heci_test.c             - Example test program
  Makefile                - Build automation
  README.md               - User documentation
  HECI_API.md             - Complete API reference
  SECURITY_ANALYSIS.md    - Security deep dive & reverse engineering
  IMPLEMENTATION_SUMMARY.md - Complete implementation summary

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”§ ESSENTIAL API

  #include "monitor/heci_monitor.h"

  heci_init();                      /* Initialize (requires root) */
  heci_start_monitor(true);         /* Start monitoring + patterns */
  sleep(60);                        /* Monitor for 60 seconds */
  heci_stop_monitor();              /* Stop gracefully */
  
  heci_log_t log;
  heci_get_log(&log);               /* Get captured traffic */
  heci_print_summary(&log);         /* Display summary */
  heci_export_log_json(&log, "/tmp/heci.json");  /* Export */
  
  heci_cleanup();                   /* Release resources */

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ WHAT IT DETECTS

  CRITICAL: HMRFPO_ENABLE (flash protection override)
  HIGH:     HMRFPO_LOCK (flash lock)
  HIGH:     ME_UNCONFIGURE (HAP/AltDisable)
  MEDIUM:   Excessive traffic (>100 msg/sec)
  LOW:      Unknown MKHI groups (fuzzing)
  LOW:      Failed authentication

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š MKHI GROUPS (Common)

  0x00 - BUP (Bring-Up Platform)
  0x02 - PM (Power Management)
  0x03 - FWCAPS (Firmware Capabilities)
  0x05 - HMRFPO (Flash Protection Override) âš ï¸ DANGEROUS
  0x0A - MCA (Memory Configuration)
  0xFF - GEN (General/Common)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ›¡ï¸ OPSEC FEATURES

  â€¢ Offline-only (no network)
  â€¢ Local logging (no remote telemetry)
  â€¢ File permissions: 0600
  â€¢ Fixed memory (no heap forensics)
  â€¢ Circular buffers (auto-cleanup)
  â€¢ <1% CPU overhead

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš™ï¸ REQUIREMENTS

  â€¢ Intel platform with ME
  â€¢ Linux with MEI driver (modprobe mei_me)
  â€¢ /dev/mei0 or /dev/mei exists
  â€¢ Root privileges
  â€¢ pthread library

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” ANALYZE LOGS

  # View JSON log
  cat /tmp/heci_traffic.json | jq .

  # Extract alerts
  jq '.heci_monitor_log.alerts' /tmp/heci_traffic.json

  # Count by group
  jq '.heci_monitor_log.messages_by_group' /tmp/heci_traffic.json

  # High-risk alerts only
  jq '.heci_monitor_log.alerts[] | select(.risk_level >= 3)' /tmp/heci_traffic.json

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“– DOCUMENTATION MAP

  Quick start        â†’ README.md
  API reference      â†’ HECI_API.md
  Security analysis  â†’ SECURITY_ANALYSIS.md
  Implementation     â†’ IMPLEMENTATION_SUMMARY.md
  Code reference     â†’ heci_monitor.h (inline comments)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš¨ CRITICAL ALERTS - INCIDENT RESPONSE

  HMRFPO_ENABLE detected:
    1. STOP - potential firmware implant attempt
    2. Verify: Is BIOS update in progress?
    3. If NO â†’ System may be compromised
    4. Dump firmware: use dump/live_dump module
    5. Compare against known-good baseline
    6. Investigate: Check recent root access logs

  ME_UNCONFIGURE detected:
    1. Verify: Is this intentional (HAP mode)?
    2. Check policy: Should ME be disabled?
    3. If unexpected â†’ Possible attack evasion
    4. Correlate with other firmware events

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”¬ REVERSE ENGINEERING NOTES

  MKHI Header: 8 bytes
    [0] group_id      - Command group
    [1] command       - Command ID
    [2] is_response   - 0=request, 1=response
    [3] reserved      - Always 0
    [4] result        - Result code (responses)
    [5-7] reserved2   - Always 0

  Payload: 0-4096 bytes (command-specific)

  Discovery methods:
    â€¢ Static analysis (Ghidra/IDA on ME firmware)
    â€¢ Dynamic analysis (strace on MEInfo)
    â€¢ Public research (me_cleaner, intelmetool)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ INTEGRATION EXAMPLE

  /* In FirmwareGuard main.c */
  #include "monitor/heci_monitor.h"

  int main(void) {
      /* Initialize all modules */
      msr_init();
      acpi_init();
      heci_init();  /* Add HECI monitor */

      /* Start background monitoring */
      heci_start_monitor(true);  /* Enable pattern detection */

      /* Main loop */
      while (running) {
          /* ... other FirmwareGuard tasks ... */

          /* Periodically check for alerts */
          heci_log_t log;
          heci_get_log(&log);
          
          if (log.alert_count > 0) {
              /* Process alerts */
              for (size_t i = 0; i < log.alert_count; i++) {
                  fg_handle_alert(&log.alerts[i]);
              }
          }

          sleep(10);
      }

      /* Cleanup on exit */
      heci_stop_monitor();
      heci_cleanup();
      return 0;
  }

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… STATUS: COMPLETE AND READY FOR TESTING

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Last Updated: 2025-12-19
Version: 1.0
